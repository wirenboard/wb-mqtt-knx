## Формат файла конфигурации для преобразования датапоинта в json объект

Содержится в файле: `/usr/share/wb-mqtt-knx/wb-mqtt-knx-jsondpt.conf`

```json
[
  {
    "id": 1,
    "name": "B1",
    "encoding" : "B1",
    "field" : [
      {"name" : "b"}
    ],
    "datapoint" : [
      {
        "subid" : 1,
        "name" : "Switch",
        "field" : [
          {"name":  "switch"}
        ]
      },
      {
        "subid" : 2,
        "name" : "Bool",
        "field" : [
          {"name":  "bool"}
        ]
      }
    ]
  },
  {
    "id": 10,
    "name": "Time",
    "encoding": "N3U5r2U6r2U6",
    "field": [
      {
        "name": "Day"
      },
      {
        "name": "Hour"
      },
      {
        "name": "Minutes"
      },
      {
        "name": "Seconds"
      }
    ],
    "datapoint": [
      {
        "subid": 1,
        "name": "TimeOfDay"
      }
    ]
  },
  {
    "id": 21,
    "name": "B8",
    "encoding": "B8",
    "field": [
      {"name": "b7"},
      {"name": "b6"},
      {"name": "b5"},
      {"name": "b4"},
      {"name": "b3"},
      {"name": "b2"},
      {"name": "b1"},
      {"name": "b0"}
    ],
    "datapoint": [
      {
        "subid": 1,
        "name": "StatusGen",
        "encoding": "r3B5",
        "field": [
          {"name": "AlarmUnAck"},
          {"name": "InAlarm"},
          {"name": "Overridden"},
          {"name": "Fault"},
          {"name": "OutOfService"}
        ]
      },
      {
        "subid": 2,
        "name": "DeviceControl",
        "encoding": "r5B3",
        "field": [
          {"name": "UserStopped"},
          {"name": "OwnIA"},
          {"name": "VerifyMode"}
        ]
      }
    ]
  }
]
```

Конфигурация представляет собой массив объектов, описывающих главную группу датапоинта и дочерние подгруппы. 
Каждый объект содержит: 

* `id` - ID главной группы. Например `1.xxx`
* `name` - имя главной группы датапоинта
* `encoding` - условный код, как транслировать телеграммы в набор полей, для передачи и приёма в JSON
* `field` - массив объектов, каждый из которых описывает поле, которое отображается в JSON объекте для приёма и передачи.
  Последовательность элементов в этом массиве соответствеует последовательности в `encoding`.
  * `name` - имя поля. Отовражается в имя в JSON объекте для обмена.
* `datapoint` - массив объектов, описывающих подгруппы датапоинтов. Например с ID: `1.001` 
Он содержит:
  * `subid` - ID подгруппы.
  * `encoding` - отдельная установка условного кода для подгруппы, как транслировать телеграммы в набор полей. 
  Если это свойство не установлено, оно применяется из родительской главной группы.
  * `field` - имеет тот же смысл и ту же структуру что и в родительской главной группе. 
  Если отсутствует, применяется свойство `field` из главной группы.

## Расшифровка свойства `encoding`
Соответствует описанию в разделе **1.3 Datapoint Type specification style** из спецификации:
<https://www.knx.org/wAssets/docs/downloads/Certification/Interworking-Datapoint-types/03_07_02-Datapoint-Types-v02.02.01-AS.pdf>

Каждый датапоинт в каталоге имеет описание `encoding`.

Задаётся строкой вида:
`TnTnTn...`

где: 
* T - тип поля
* n - ширина поля

Последовательность и ширина полей соответствует положению в полезной нагрузке KNX телеграммы начиная со старшего бита первого байта.  
Если общая ширина полей `encoding` меньше или равно 6 битам, то ими заполняется первый байт полезной нагрузки, 
и выравнивается по правому краю (младшему биту). 
Иначе первый байт полезной нагрузки заполняется нулями. И поля заполняются со второго байта.

Поддерживаются несколько типов:
* `B` - битовая маска. Каждый бит в битовой маске должен соответствовать отдельному полю.
* `A` - единичный символ или массив символов фиксированный длины. Может иметь ширину 8 и 112 битов соответственно.
* `U` - беззнаковое целое.
* `N` - перечисление.
* `V` - знаковое целое. Может иметь ширину 8, 16, 32, 64 бита.
* `F` - число с плавающей точкой. Может иметь ширину 16 и 32 бита.
* `r` - резервные биты. Для них поле не создаётся. Являются пустым заполнителем.

ПРИМЕР:
`U16` указывает на 16-битное целое число без знака.

## Примеры объектов конвертации JSON <=> KNX

* `1.001`:
    ```json
    {"switch":true}
    ```
* `10.001`:
    ```json
    {"Day":0,"Hour":22,"Minutes":1,"Seconds":2}
    ```

* `21.002`  
    ```json
    {"UserStopped":true,"OwnIA":false,"VerifyMode":true}
    ```